{"version":3,"sources":["../../../../src/app/components/modules/TopRightMenu.jsx"],"names":["userActions","appActions","defaultNavigate","e","metaKey","ctrlKey","preventDefault","a","target","nodeName","toLowerCase","parentNode","browserHistory","push","pathname","search","hash","TopRightMenu","username","showLogin","logout","loggedIn","vertical","navigate","toggleOffCanvasMenu","probablyLoggedIn","nightmodeEnabled","toggleNightmode","userPath","mcn","mcl","lcn","nav","submit_story","$STM_Config","read_only_mode","submit_icon","feed_link","replies_link","wallet_link","account_link","comments_link","reset_password_link","settings_link","pathCheck","user_menu","link","icon","value","onClick","paddingTop","paddingBottom","SIGNUP_URL","propTypes","React","PropTypes","string","bool","func","isRequired","process","env","BROWSER","state","offchain","get","routing","locationBeforeTransitions","user","getIn","dispatch","type"],"mappings":"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","file":"TopRightMenu.js","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router';\nimport { connect } from 'react-redux';\nimport { browserHistory } from 'react-router';\nimport tt from 'counterpart';\nimport DropdownMenu from 'app/components/elements/DropdownMenu';\nimport Icon from 'app/components/elements/Icon';\nimport * as userActions from 'app/redux/UserReducer';\nimport * as appActions from 'app/redux/AppReducer';\nimport Userpic from 'app/components/elements/Userpic';\nimport LoadingIndicator from 'app/components/elements/LoadingIndicator';\nimport { SIGNUP_URL } from 'shared/constants';\n\nconst defaultNavigate = e => {\n    if (e.metaKey || e.ctrlKey) {\n        // prevent breaking anchor tags\n    } else {\n        e.preventDefault();\n    }\n    const a =\n        e.target.nodeName.toLowerCase() === 'a'\n            ? e.target\n            : e.target.parentNode;\n    browserHistory.push(a.pathname + a.search + a.hash);\n};\n\nfunction TopRightMenu({\n    username,\n    showLogin,\n    logout,\n    loggedIn,\n    vertical,\n    navigate,\n    toggleOffCanvasMenu,\n    probablyLoggedIn,\n    nightmodeEnabled,\n    toggleNightmode,\n    userPath,\n}) {\n    const mcn = 'menu' + (vertical ? ' vertical show-for-small-only' : '');\n    const mcl = vertical ? '' : ' sub-menu';\n    const lcn = vertical ? '' : 'show-for-medium';\n    const nav = navigate || defaultNavigate;\n    const submit_story = $STM_Config.read_only_mode ? null : (\n        <li className={lcn + ' submit-story' + (vertical ? ' last' : '')}>\n            <a href=\"/submit.html\" onClick={nav}>\n                {tt('g.submit_a_story')}\n            </a>\n        </li>\n    );\n    const submit_icon = $STM_Config.read_only_mode ? null : (\n        <li className=\"show-for-small-only\">\n            <Link to=\"/submit.html\">\n                <Icon name=\"pencil2\" />\n            </Link>\n        </li>\n    );\n    const feed_link = `/@${username}/feed`;\n    const replies_link = `/@${username}/recent-replies`;\n    const wallet_link = `/@${username}/transfers`;\n    const account_link = `/@${username}`;\n    const comments_link = `/@${username}/comments`;\n    const reset_password_link = `/@${username}/password`;\n    const settings_link = `/@${username}/settings`;\n    const pathCheck = userPath === '/submit.html' ? true : null;\n    if (loggedIn) {\n        // change back to if(username) after bug fix:  Clicking on Login does not cause drop-down to close #TEMP!\n        const user_menu = [\n            {\n                link: feed_link,\n                icon: 'home',\n                value: tt('g.feed'),\n            },\n            { link: account_link, icon: 'profile', value: tt('g.blog') },\n            { link: comments_link, icon: 'replies', value: tt('g.comments') },\n            {\n                link: replies_link,\n                icon: 'reply',\n                value: tt('g.replies'),\n            },\n            {\n                link: wallet_link,\n                icon: 'wallet',\n                value: tt('g.wallet'),\n            },\n            {\n                link: '#',\n                icon: 'eye',\n                onClick: toggleNightmode,\n                value: tt('g.toggle_nightmode'),\n            },\n            {\n                link: reset_password_link,\n                icon: 'key',\n                value: tt('g.change_password'),\n            },\n            { link: settings_link, icon: 'cog', value: tt('g.settings') },\n            loggedIn\n                ? {\n                      link: '#',\n                      icon: 'enter',\n                      onClick: logout,\n                      value: tt('g.logout'),\n                  }\n                : { link: '#', onClick: showLogin, value: tt('g.login') },\n        ];\n        return (\n            <ul className={mcn + mcl}>\n                {!pathCheck ? submit_story : null}\n                {!vertical && submit_icon}\n                {!vertical && (\n                    <DropdownMenu\n                        className={'Header__usermenu'}\n                        items={user_menu}\n                        title={username}\n                        el=\"span\"\n                        selected={tt('g.rewards')}\n                        position=\"left\"\n                    >\n                        <li className={'Header__userpic '}>\n                            <span title={username}>\n                                <Userpic account={username} />\n                            </span>\n                        </li>\n                    </DropdownMenu>\n                )}\n\n                {toggleOffCanvasMenu && (\n                    <li className=\"toggle-menu Header__hamburger\">\n                        <a href=\"#\" onClick={toggleOffCanvasMenu}>\n                            <span className=\"hamburger\" />\n                        </a>\n                    </li>\n                )}\n            </ul>\n        );\n    }\n    if (probablyLoggedIn) {\n        return (\n            <ul className={mcn + mcl}>\n                <li className={lcn} style={{ paddingTop: 0, paddingBottom: 0 }}>\n                    <LoadingIndicator type=\"circle\" inline />\n                </li>\n                {toggleOffCanvasMenu && (\n                    <li className=\"toggle-menu Header__hamburger\">\n                        <a href=\"#\" onClick={toggleOffCanvasMenu}>\n                            <span className=\"hamburger\" />\n                        </a>\n                    </li>\n                )}\n            </ul>\n        );\n    }\n    return (\n        <ul className={mcn + mcl}>\n            <li className={lcn}>\n                <a href={SIGNUP_URL}>{tt('g.sign_up')}</a>\n            </li>\n            <li className={lcn}>\n                <a href=\"/login.html\" onClick={showLogin}>\n                    {tt('g.login')}\n                </a>\n            </li>\n            {submit_story}\n            {!vertical && submit_icon}\n            {toggleOffCanvasMenu && (\n                <li className=\"toggle-menu Header__hamburger\">\n                    <a href=\"#\" onClick={toggleOffCanvasMenu}>\n                        <span className=\"hamburger\" />\n                    </a>\n                </li>\n            )}\n        </ul>\n    );\n}\n\nTopRightMenu.propTypes = {\n    username: React.PropTypes.string,\n    loggedIn: React.PropTypes.bool,\n    probablyLoggedIn: React.PropTypes.bool,\n    showLogin: React.PropTypes.func.isRequired,\n    logout: React.PropTypes.func.isRequired,\n    vertical: React.PropTypes.bool,\n    navigate: React.PropTypes.func,\n    toggleOffCanvasMenu: React.PropTypes.func,\n    nightmodeEnabled: React.PropTypes.bool,\n    toggleNightmode: React.PropTypes.func,\n};\n\nexport default connect(\n    state => {\n        if (!process.env.BROWSER) {\n            return {\n                username: null,\n                loggedIn: false,\n                probablyLoggedIn: !!state.offchain.get('account'),\n            };\n        }\n        const userPath = state.routing.locationBeforeTransitions.pathname;\n        const username = state.user.getIn(['current', 'username']);\n        const loggedIn = !!username;\n        return {\n            username,\n            loggedIn,\n            userPath,\n            probablyLoggedIn: false,\n            nightmodeEnabled: state.user.getIn([\n                'user_preferences',\n                'nightmode',\n            ]),\n        };\n    },\n    dispatch => ({\n        showLogin: e => {\n            if (e) e.preventDefault();\n            dispatch(userActions.showLogin());\n        },\n        logout: e => {\n            if (e) e.preventDefault();\n            dispatch(userActions.logout({ type: 'default' }));\n        },\n        toggleNightmode: e => {\n            if (e) e.preventDefault();\n            dispatch(appActions.toggleNightmode());\n        },\n    })\n)(TopRightMenu);\n"]}