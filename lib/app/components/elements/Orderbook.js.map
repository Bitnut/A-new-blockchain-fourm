{"version":3,"sources":["../../../../src/app/components/elements/Orderbook.jsx"],"names":["Orderbook","state","buyIndex","sellIndex","animate","setTimeout","setState","back","indexKey","props","side","newIndex","Math","min","max","orders","length","newState","buy","DEBT_TOKEN_SHORT","CURRENCY_SIGN","LIQUID_TOKEN","total","map","order","index","getSBDAmount","onClick","getStringSBD","getStringPrice","filter","a","currentIndex","renderBuySellHeader","renderOrdersRows","_setBuySellPage","bind","React","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;IAMqBA,S;;;AACjB,yBAAc;AAAA;;AAAA;;AAGV,cAAKC,KAAL,GAAa;AACTC,sBAAU,CADD;AAETC,uBAAW,CAFF;AAGTC,qBAAS;AAHA,SAAb;AAHU;AAQb;;;;4CAEmB;AAAA;;AAChBC,uBAAW,YAAM;AACb,uBAAKC,QAAL,CAAc;AACVF,6BAAS;AADC,iBAAd;AAGH,aAJD,EAIG,IAJH;AAKH;;;wCAEeG,I,EAAM;AAAA;;AAClB,gBAAMC,WAAW,KAAKC,KAAL,CAAWC,IAAX,KAAoB,MAApB,GAA6B,UAA7B,GAA0C,WAA3D;;AAEA,gBAAIC,WAAW,KAAKV,KAAL,CAAWO,QAAX,KAAwBD,OAAO,EAAP,GAAY,CAAC,EAArC,CAAf;;AAEAI,uBAAWC,KAAKC,GAAL,CACPD,KAAKE,GAAL,CAAS,CAAT,EAAYH,QAAZ,CADO,EAEP,KAAKF,KAAL,CAAWM,MAAX,CAAkBC,MAAlB,GAA2B,EAFpB,CAAX;;AAKA,gBAAIC,WAAW,EAAf;AACAA,qBAAST,QAAT,IAAqBG,QAArB;AACA;AACA,gBAAIA,aAAa,KAAKV,KAAL,CAAWO,QAAX,CAAjB,EAAuC;AACnCS,yBAASb,OAAT,GAAmB,KAAnB;AACH;AACD;AACA,iBAAKE,QAAL,CAAcW,QAAd,EAAwB,YAAM;AAC1B,uBAAKX,QAAL,CAAc,EAAEF,SAAS,IAAX,EAAd;AACH,aAFD;AAGH;;;8CAEqB;AAClB,gBAAIc,MAAM,KAAKT,KAAL,CAAWC,IAAX,KAAoB,MAA9B;;AAEA,mBACI;AAAA;AAAA;AACI;AAAA;AAAA;AACI;AAAA;AAAA;AACKQ,8BACK,2BACI,iDADJ,EAEI,EAAEC,iDAAF,EAAoBC,2CAApB,EAFJ,CADL,GAKK,2BAAG,SAAH;AANV,qBADJ;AASI;AAAA;AAAA;AACKF,8BACQC,+BADR,UAC6BC,4BAD7B,SAEKC;AAHV,qBATJ;AAcI;AAAA;AAAA;AACKH,8BACKG,2BADL,GAEQF,+BAFR,UAE6BC,4BAF7B;AADL,qBAdJ;AAmBI;AAAA;AAAA;AACKF,8BACK,2BAAG,SAAH,CADL,GAEK,2BACI,iDADJ,EAEI,EAAEC,iDAAF,EAAoBC,2CAApB,EAFJ;AAHV;AAnBJ;AADJ,aADJ;AAgCH;;;2CAEkB;AAAA;;AAAA,yBACU,KAAKX,KADf;AAAA,gBACPM,MADO,UACPA,MADO;AAAA,gBACCL,IADD,UACCA,IADD;;AAEf,gBAAMQ,MAAMR,SAAS,MAArB;;AAEA,gBAAI,CAACK,OAAOC,MAAZ,EAAoB;AAChB,uBAAO,IAAP;AACH;AANc,yBAOiB,KAAKf,KAPtB;AAAA,gBAOPC,QAPO,UAOPA,QAPO;AAAA,gBAOGC,SAPH,UAOGA,SAPH;;;AASf,gBAAImB,QAAQ,CAAZ;AACA,mBAAOP,OACFQ,GADE,CACE,UAACC,KAAD,EAAQC,KAAR,EAAkB;AACnBH,yBAASE,MAAME,YAAN,EAAT;AACA,oBACID,UAAUP,MAAMhB,QAAN,GAAiBC,SAA3B,KACAsB,QAAQ,CAACP,MAAMhB,QAAN,GAAiBC,SAAlB,IAA+B,EAF3C,EAGE;AACE,2BACI,8BAAC,sBAAD;AACI,iCAAS,OAAKM,KAAL,CAAWkB,OADxB;AAEI,iCAAS,OAAK1B,KAAL,CAAWG,OAFxB;AAGI,6BACIM,OACAc,MAAMI,YAAN,EADA,GAEAJ,MAAMK,cAAN,EANR;AAQI,+BAAOJ,KARX;AASI,+BAAOD,KATX;AAUI,8BAAMd,IAVV;AAWI,+BAAOY;AAXX,sBADJ;AAeH;AACD,uBAAO,IAAP;AACH,aAxBE,EAyBFQ,MAzBE,CAyBK,aAAK;AACT,uBAAO,CAAC,CAACC,CAAT;AACH,aA3BE,CAAP;AA4BH;;;iCAEQ;AAAA,gBACGhB,MADH,GACc,KAAKN,KADnB,CACGM,MADH;;AAEL,gBAAMG,MAAM,KAAKT,KAAL,CAAWC,IAAX,KAAoB,MAAhC;AAFK,0BAG2B,KAAKT,KAHhC;AAAA,gBAGGC,QAHH,WAGGA,QAHH;AAAA,gBAGaC,SAHb,WAGaA,SAHb;;;AAKL,gBAAM6B,eAAed,MAAMhB,QAAN,GAAiBC,SAAtC;;AAEA,mBACI;AAAA;AAAA;AACI;AAAA;AAAA,sBAAO,WAAU,mBAAjB;AACK,yBAAK8B,mBAAL,EADL;AAEI;AAAA;AAAA;AAAQ,6BAAKC,gBAAL;AAAR;AAFJ,iBADJ;AAKI;AAAA;AAAA;AACI;AAAA;AAAA,0BAAI,WAAU,OAAd;AACI;AAAA;AAAA;AACI;AAAA;AAAA;AACI,+CACI,yBACChB,MAAM,YAAN,GAAqB,YADtB,KAECc,iBAAiB,CAAjB,GAAqB,WAArB,GAAmC,EAFpC,CAFR;AAMI,6CAAS,KAAKG,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,EAAgC,KAAhC,CANb;AAOI,kDAAW;AAPf;AASI;AAAA;AAAA,sCAAM,eAAY,MAAlB;AAAA;AACW,uCADX;AAEKlB,0CACK,2BAAG,mBAAH,CADL,GAEK,2BAAG,kBAAH;AAJV;AATJ;AADJ,yBADJ;AAmBI;AAAA;AAAA;AACI;AAAA;AAAA;AACI,+CACI,yBACCA,MAAM,aAAN,GAAsB,aADvB,KAECc,gBAAgBjB,OAAOC,MAAP,GAAgB,EAAhC,GACK,WADL,GAEK,EAJN,CAFR;AAQI,6CAAS,KAAKmB,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,EAAgC,IAAhC,CARb;AASI,kDAAW;AATf;AAWI;AAAA;AAAA,sCAAM,eAAY,MAAlB;AACKlB,0CACK,2BAAG,kBAAH,CADL,GAEK,2BAAG,mBAAH,CAHV;AAGmC,uCAHnC;AAAA;AAAA;AAXJ;AADJ;AAnBJ;AADJ;AALJ,aADJ;AAkDH;;;EA/KkCmB,gBAAMC,S;;kBAAxBtC,S","file":"Orderbook.js","sourcesContent":["import React from 'react';\nimport OrderbookRow from './OrderbookRow';\nimport tt from 'counterpart';\nimport {\n    LIQUID_TOKEN,\n    DEBT_TOKEN_SHORT,\n    CURRENCY_SIGN,\n} from 'app/client_config';\n\nexport default class Orderbook extends React.Component {\n    constructor() {\n        super();\n\n        this.state = {\n            buyIndex: 0,\n            sellIndex: 0,\n            animate: false,\n        };\n    }\n\n    componentDidMount() {\n        setTimeout(() => {\n            this.setState({\n                animate: true,\n            });\n        }, 2000);\n    }\n\n    _setBuySellPage(back) {\n        const indexKey = this.props.side === 'bids' ? 'buyIndex' : 'sellIndex';\n\n        let newIndex = this.state[indexKey] + (back ? 10 : -10);\n\n        newIndex = Math.min(\n            Math.max(0, newIndex),\n            this.props.orders.length - 10\n        );\n\n        let newState = {};\n        newState[indexKey] = newIndex;\n        // Disable animations while paging\n        if (newIndex !== this.state[indexKey]) {\n            newState.animate = false;\n        }\n        // Reenable animatons after paging complete\n        this.setState(newState, () => {\n            this.setState({ animate: true });\n        });\n    }\n\n    renderBuySellHeader() {\n        let buy = this.props.side === 'bids';\n\n        return (\n            <thead>\n                <tr>\n                    <th>\n                        {buy\n                            ? tt(\n                                  'market_jsx.total_DEBT_TOKEN_SHORT_CURRENCY_SIGN',\n                                  { DEBT_TOKEN_SHORT, CURRENCY_SIGN }\n                              )\n                            : tt('g.price')}\n                    </th>\n                    <th>\n                        {buy\n                            ? `${DEBT_TOKEN_SHORT} (${CURRENCY_SIGN})`\n                            : LIQUID_TOKEN}\n                    </th>\n                    <th>\n                        {buy\n                            ? LIQUID_TOKEN\n                            : `${DEBT_TOKEN_SHORT} (${CURRENCY_SIGN})`}\n                    </th>\n                    <th>\n                        {buy\n                            ? tt('g.price')\n                            : tt(\n                                  'market_jsx.total_DEBT_TOKEN_SHORT_CURRENCY_SIGN',\n                                  { DEBT_TOKEN_SHORT, CURRENCY_SIGN }\n                              )}\n                    </th>\n                </tr>\n            </thead>\n        );\n    }\n\n    renderOrdersRows() {\n        const { orders, side } = this.props;\n        const buy = side === 'bids';\n\n        if (!orders.length) {\n            return null;\n        }\n        const { buyIndex, sellIndex } = this.state;\n\n        let total = 0;\n        return orders\n            .map((order, index) => {\n                total += order.getSBDAmount();\n                if (\n                    index >= (buy ? buyIndex : sellIndex) &&\n                    index < (buy ? buyIndex : sellIndex) + 10\n                ) {\n                    return (\n                        <OrderbookRow\n                            onClick={this.props.onClick}\n                            animate={this.state.animate}\n                            key={\n                                side +\n                                order.getStringSBD() +\n                                order.getStringPrice()\n                            }\n                            index={index}\n                            order={order}\n                            side={side}\n                            total={total}\n                        />\n                    );\n                }\n                return null;\n            })\n            .filter(a => {\n                return !!a;\n            });\n    }\n\n    render() {\n        const { orders } = this.props;\n        const buy = this.props.side === 'bids';\n        const { buyIndex, sellIndex } = this.state;\n\n        const currentIndex = buy ? buyIndex : sellIndex;\n\n        return (\n            <div>\n                <table className=\"Market__orderbook\">\n                    {this.renderBuySellHeader()}\n                    <tbody>{this.renderOrdersRows()}</tbody>\n                </table>\n                <nav>\n                    <ul className=\"pager\">\n                        <li>\n                            <div\n                                className={\n                                    'button tiny hollow ' +\n                                    (buy ? 'float-left' : 'float-left') +\n                                    (currentIndex === 0 ? ' disabled' : '')\n                                }\n                                onClick={this._setBuySellPage.bind(this, false)}\n                                aria-label=\"Previous\"\n                            >\n                                <span aria-hidden=\"true\">\n                                    &larr;{' '}\n                                    {buy\n                                        ? tt('market_jsx.higher')\n                                        : tt('market_jsx.lower')}\n                                </span>\n                            </div>\n                        </li>\n                        <li>\n                            <div\n                                className={\n                                    'button tiny hollow ' +\n                                    (buy ? 'float-right' : 'float-right') +\n                                    (currentIndex >= orders.length - 10\n                                        ? ' disabled'\n                                        : '')\n                                }\n                                onClick={this._setBuySellPage.bind(this, true)}\n                                aria-label=\"Next\"\n                            >\n                                <span aria-hidden=\"true\">\n                                    {buy\n                                        ? tt('market_jsx.lower')\n                                        : tt('market_jsx.higher')}{' '}\n                                    &rarr;\n                                </span>\n                            </div>\n                        </li>\n                    </ul>\n                </nav>\n            </div>\n        );\n    }\n}\n"]}