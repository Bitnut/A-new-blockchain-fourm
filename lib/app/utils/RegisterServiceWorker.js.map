{"version":3,"sources":["../../../src/app/utils/RegisterServiceWorker.js"],"names":["registerServiceWorker","navigator","serviceWorker","resolve","register","scope","then","registration","ready","catch","console","error","e","serviceWorkerRegistration","subscription","pushManager","getSubscription","subscribe","userVisibleOnly","rawKey","getKey","key","btoa","String","fromCharCode","apply","Uint8Array","rawAuthSecret","authSecret","endpoint","keys","p256dh","auth"],"mappings":";;;;;;;;;;kBAAwBA,qB;;;;AAAT,SAASA,qBAAT,GAAiC;AAC5C,QAAI,CAACC,UAAUC,aAAf,EAA8B,OAAO,kBAAQC,OAAR,CAAgB,KAAhB,CAAP;AAC9B,WAAOF,UAAUC,aAAV,CACFE,QADE,CACO,oBADP,EAC6B,EAAEC,OAAO,GAAT,EAD7B,EAEFC,IAFE,CAEG,UAASC,YAAT,EAAuB;AACzBN,kBAAUC,aAAV,CAAwBM,KAAxB,CAA8BC,KAA9B,CAAoC;AAAA,mBAChCC,QAAQC,KAAR,CAAc,oCAAd,EAAoDC,CAApD,CADgC;AAAA,SAApC;AAGA,eAAOX,UAAUC,aAAV,CAAwBM,KAAxB,CAA8BF,IAA9B,CAAmC,UACtCO,yBADsC,EAExC;AACE,gBAAIC,eAAeD,0BAA0BE,WAA1B,CAAsCC,eAAtC,EAAnB;AACA,mBAAOF,aAAaR,IAAb,CAAkB,UAASQ,YAAT,EAAuB;AAC5C,oBAAIA,YAAJ,EAAkB;AACd,2BAAOA,YAAP;AACH;AACD,uBAAOD,0BAA0BE,WAA1B,CAAsCE,SAAtC,CAAgD;AACnDC,qCAAiB;AADkC,iBAAhD,CAAP;AAGH,aAPM,CAAP;AAQH,SAZM,CAAP;AAaH,KAnBE,EAoBFZ,IApBE,CAoBG,UAASQ,YAAT,EAAuB;AACzB,YAAMK,SAASL,aAAaM,MAAb,GACTN,aAAaM,MAAb,CAAoB,QAApB,CADS,GAET,EAFN;AAGA,YAAMC,MAAMF,SACNG,KAAKC,OAAOC,YAAP,CAAoBC,KAApB,CAA0B,IAA1B,EAAgC,IAAIC,UAAJ,CAAeP,MAAf,CAAhC,CAAL,CADM,GAEN,EAFN;AAGA,YAAMQ,gBAAgBb,aAAaM,MAAb,GAChBN,aAAaM,MAAb,CAAoB,MAApB,CADgB,GAEhB,EAFN;AAGA,YAAMQ,aAAaD,gBACbL,KACIC,OAAOC,YAAP,CAAoBC,KAApB,CACI,IADJ,EAEI,IAAIC,UAAJ,CAAeC,aAAf,CAFJ,CADJ,CADa,GAOb,EAPN;AAQA,eAAO;AACHE,sBAAUf,aAAae,QADpB;AAEHC,kBAAM;AACFC,wBAAQV,GADN;AAEFW,sBAAMJ;AAFJ;AAFH,SAAP;AAOH,KA7CE,CAAP;AA8CH","file":"RegisterServiceWorker.js","sourcesContent":["export default function registerServiceWorker() {\n    if (!navigator.serviceWorker) return Promise.resolve(false);\n    return navigator.serviceWorker\n        .register('/service-worker.js', { scope: '/' })\n        .then(function(registration) {\n            navigator.serviceWorker.ready.catch(e =>\n                console.error('-- registerServiceWorker error -->', e)\n            );\n            return navigator.serviceWorker.ready.then(function(\n                serviceWorkerRegistration\n            ) {\n                let subscription = serviceWorkerRegistration.pushManager.getSubscription();\n                return subscription.then(function(subscription) {\n                    if (subscription) {\n                        return subscription;\n                    }\n                    return serviceWorkerRegistration.pushManager.subscribe({\n                        userVisibleOnly: true,\n                    });\n                });\n            });\n        })\n        .then(function(subscription) {\n            const rawKey = subscription.getKey\n                ? subscription.getKey('p256dh')\n                : '';\n            const key = rawKey\n                ? btoa(String.fromCharCode.apply(null, new Uint8Array(rawKey)))\n                : '';\n            const rawAuthSecret = subscription.getKey\n                ? subscription.getKey('auth')\n                : '';\n            const authSecret = rawAuthSecret\n                ? btoa(\n                      String.fromCharCode.apply(\n                          null,\n                          new Uint8Array(rawAuthSecret)\n                      )\n                  )\n                : '';\n            return {\n                endpoint: subscription.endpoint,\n                keys: {\n                    p256dh: key,\n                    auth: authSecret,\n                },\n            };\n        });\n}\n"]}